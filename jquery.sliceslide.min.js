!function(e){e.fn.sliceSlide=function(l,s){function t(l){e(u.slidesBox).each(function(s){var t=e.extend(!0,{},d);t.culture=l,t.el=e.extend({},{slidesBox:e(this),slidesBoxIndex:s,intervalTime:1e3*u.slideTime}),t.init(e(this),s)})}function i(){e.getJSON(u.templatesCultureUrl.replace("##CULTURE##",u.culture),function(e){t(e)})}function n(){if(_.isObject(u.templatesCultureJson)){var e;e=_.isObject(u.templatesCultureJson[u.culture])?u.templatesCultureJson[u.culture]:u.fallbackCultureJson,t(e)}else i()}function o(){e.get(u.templatesUrl,function(l){e("body").append('<div id="'+u.idSliceSlideTemplates+'">'+l+"</div>"),n()})}var d,r,a={slidesBox:"[data-slice-slide-box]",slidesBoxSlide:"[data-slice-slide]",slidesBoxSlideActive:".slice-slide-active",slidesBoxControls:"[data-slice-slide-controls]",slidesBoxControlsFixed:"[data-slice-slide-controls-fixed]",slidesBoxControlsPrevAndNext:"[data-slice-slide-controls-prev-and-next]",slidesBoxControlsNext:"[data-slice-slide-controls-next]",slidesBoxControlsPrev:"[data-slice-slide-controls-prev]",slidesBoxControlsPauseResume:"[data-slice-slide-controls-pause-resume]",slidesBoxControlsStatePlaying:"[data-slice-slide-playing]",links:'a, [role="link"]',templatesTranslucent:"#slice-slide-translucent",templatesControls:"#slice-slide-controls",templateControlsPlaying:"#slice-slide-controls-playing",templateControlsPaused:"#slice-slide-controls-paused",classesActive:"slice-slide-active",attrDestination:"data-slice-slide-destination",translucentElement:!0,attrThumb:"data-thumbnail",thumbnailsInControls:!1,prefixId:"jquery-slice-slide-",numberSimultaneousSlides:1,effectTime:150,autoStart:!0,loop:!0,templatesUrl:"jquery.sliceslide.templates.html",templatesCultureUrl:"sliceslide_cultures/jquery.sliceslide.##CULTURE##.json",idSliceSlideTemplates:"jquery-slice-slide-templates",slideTemplatesPlaceholder:!0,setTemplateSettings:!0,templateSettings:{interpolate:/\{\{(.+?)\}\}/g,evaluate:/\[\[(.+?)\]\]/g},slideTime:3,culture:e("html").attr("lang")||"en"},u=e.extend(!0,{},a,l),c={culture:{},el:{},keys:{intro:13,tab:9,up:38,right:39,down:40,left:37},init:function(){r=this,r.op.numberSimultaneousSlides=r.op.thumbnailsInControls?1:r.op.numberSimultaneousSlides,r.el.slides=r.el.slidesBox.find(u.slidesBoxSlide),r.el.idSlideBox=r.getSlidesBoxId(),r.el.slidesBox.attr("id",r.el.idSlideBox),r.setTemplateSettings(),r.initAria(),r.setSlides(),r.controls()},initAria:function(){r.ariaSlideBox(),r.ariaSlides()},setTemplateSettings:function(){u.setTemplateSettings&&(_.templateSettings=u.templateSettings)},ariaSlideBox:function(){r.el.slidesBox.is('[role="listbox"]')||r.el.slidesBox.attr("role","listbox")},addAriaAttributes:function(e){var l={};e.is('[tabindex="0"]')||(l.tabindex="0"),e.is('[role="option"]')||(l.role="option"),e.attr(l)},ariaSlides:function(){e.each(r.el.slides,function(l,s){var t=e(s);r.addAriaAttributes(t),t.on("keydown",function(e){(e.keyCode===r.keys.left||e.keyCode===r.keys.up)&&(e.preventDefault(),r.pauseSlide(),t.prev(u.slidesBoxSlideActive).length>0?t.prev(u.slidesBoxSlideActive).focus():r.changeSlide(-1,!0)),(e.keyCode===r.keys.right||e.keyCode===r.keys.down)&&(e.preventDefault(),r.pauseSlide(),t.next(u.slidesBoxSlideActive).length>0?t.next(u.slidesBoxSlideActive).focus():r.changeSlide(1,!0))})})},ariaControlsFixed:function(){r.el.fixedLinks.on("keydown",function(l){var s=e(this).closest(u.slidesBoxControlsFixed),t=s.prev(u.slidesBoxControlsFixed),i=s.next(u.slidesBoxControlsFixed),n=s.siblings(u.slidesBoxControlsFixed);l.shiftKey&&l.keyCode===r.keys.tab?(l.preventDefault(),r.el.slideControlsBox.find(u.slidesBoxControlsPrevAndNext).first().find(u.links).first().focus()):l.shiftKey||l.keyCode!==r.keys.tab||(l.preventDefault(),r.el.slides.filter('[aria-selected="true"]').first().focus()),(l.keyCode===r.keys.left||l.keyCode===r.keys.up)&&(l.preventDefault(),t.length>0?t.find(u.links).first().focus():n.last().find(u.links).first().focus()),(l.keyCode===r.keys.right||l.keyCode===r.keys.down)&&(l.preventDefault(),i.length>0?i.find(u.links).first().focus():n.first().find(u.links).first().focus())})},getSlidesBoxId:function(){for(var l=u.prefixId+(r.el.slidesBoxIndex+1);e("#"+l).length;)r.el.slidesBoxIndex+=1,l=u.prefixId+(r.el.slidesBoxIndex+1);return l},tmpl:function(l,s){var t=e(l).html();return _.template(t,s)},setSlides:function(){r.el.slides.each(function(l,s){e(s).attr("id",r.el.idSlideBox+"-"+(l+1)),u.translucentElement&&e(s).append(r.tmpl(u.templatesTranslucent),{text:r.culture})}),r.initialSlides()},initialSlides:function(){var e=r.el.slidesBox.find(u.slidesBoxSlide),l=e.filter(":lt("+u.numberSimultaneousSlides+")"),s=e.filter(":gt("+(u.numberSimultaneousSlides-1)+")");l.addClass(u.classesActive),s.hide()},getThumbnailsRoutes:function(){var l=[];return r.el.slides.each(function(){l.push(e(this).attr(r.op.attrThumb))}),l},controls:function(){var e=r.el.slides.length/r.op.numberSimultaneousSlides,l=Math.ceil(e),s=r.op.thumbnailsInControls===!0?r.getThumbnailsRoutes():null;r.el.slidesBox.prepend(r.tmpl(r.op.templatesControls,{id:r.el.idSlideBox,slides:r.el.slides,pagesNumber:l,numberSimultaneousSlides:r.op.numberSimultaneousSlides,text:r.culture,root:r.op.root,thumbnails:s})),r.startSlide()},getControls:function(e){return r.el.slideControlsBox.find(e)},startSlide:function(){r.el.slideControlsBox=r.el.slidesBox.find(u.slidesBoxControls).first(),r.el.slideControls=r.getSlideControls(),u.loop||r.el.slideControls.previous.hide(),u.autoStart||r.el.slideControls.pauseResume.remove(),r.afterStartSlide()},afterStartSlide:function(){r.eventControlsNextAndPrevious(),r.eventControlsFixed(),r.eventControlsPauseResume(),r.startInterval()},startInterval:function(){u.autoStart&&(r.el.interval=setInterval(function(){r.changeSlide(1)},r.el.intervalTime))},getSlideControls:function(){return{fixed:r.getControls(u.slidesBoxControlsFixed),previous:r.getControls(u.slidesBoxControlsPrev),next:r.getControls(u.slidesBoxControlsNext),pauseResume:r.getControls(u.slidesBoxControlsPauseResume)}},isVisible:function(l){return e(l).is(":visible")},eventControlsNextAndPrevious:function(){var e="click.sliceControls",l=r.el.slideControls.previous,s=r.el.slideControls.next;r.touchControls(l,s),l.off(e).on(e,function(e){r.launchChangeSlide(e,-1)}),s.off(e).on(e,function(e){r.launchChangeSlide(e,1)})},touchControls:function(l,s){_.isFunction(e.isTouchCapable)&&e.isTouchCapable()&&r.el.slides.off("swipe.slides").on("swipe.slides",function(e,t){"right"===t.direction&&r.isVisible(l)?r.launchChangeSlide(e,-1):"left"===t.direction&&r.isVisible(s)&&r.launchChangeSlide(e,1)})},launchChangeSlide:function(e,l){e.preventDefault(),r.pauseSlide(),r.changeSlide(l)},eventControlsFixed:function(){r.el.fixedLinks=r.el.slideControls.fixed.find(u.links),r.el.fixedLinks.on("click",r.clickFixedLink),r.ariaControlsFixed()},clickFixedLink:function(l){l.preventDefault();var s=e(this).closest(u.slidesBoxControlsFixed),t=s.siblings(u.slidesBoxSlideActive);r.pauseSlide(),r.goToSlide(e(this),e(this).attr(u.attrDestination),s,t,1,!0)},eventControlsPauseResume:function(){r.el.slideControls.pauseResume.bind("click",function(e){e.preventDefault(),r.el.slideControls.pauseResume.find(u.slidesBoxControlsStatePlaying).length>0?r.pauseSlide():(r.el.slideControls.pauseResume.html(r.tmpl(u.templateControlsPlaying,{text:r.culture})),r.resumeSlide())})},resumeSlide:function(){r.startInterval()},pauseSlide:function(){clearInterval(r.el.interval),r.el.slideControls.pauseResume.html(r.tmpl(u.templateControlsPaused,{text:r.culture}))},changeSlide:function(e,l){var s,t,i,n=r.el.slideControlsBox.find(u.slidesBoxSlideActive).first();e>0?(s=n.is(":last-child")?n.siblings().first():n.next(),u.loop||r.el.slideControls.previous.show()):(s=n.is(":first-child")?n.siblings().last():n.prev(),u.loop||r.el.slideControls.next.show()),u.loop||(s.is(":last-child")?r.el.slideControls.next.hide():s.is(":first-child")&&r.el.slideControls.previous.hide()),t=s.find(u.links).first(),i=t.attr(u.attrDestination),r.goToSlide(t,i,s,n,e,l)},goToSlide:function(l,s,t,i,n,o){i.removeClass(u.classesActive),t.addClass(u.classesActive);var d,a=e(s).siblings(u.slidesBoxSlideActive);e(s).is(":hidden")&&a.removeClass(u.classesActive).removeAttr("aria-selected").attr("tabindex","0").fadeOut(u.effectTime,function(){if(u.numberSimultaneousSlides>1)for(var l=e(s).next(),t=1;t<u.numberSimultaneousSlides;)l.addClass(u.classesActive),l=l.next(),t+=1;e(s).addClass(u.classesActive),d=e(s).add(e(s).siblings(u.slidesBoxSlideActive)),d.attr({"aria-selected":!0,tabindex:"0"}).fadeIn(u.effectTime,function(){o&&n>0?d.first().focus():o&&0>n&&d.last().focus()})}),u.loop||(t.is(":last-child")?r.el.slideControls.next.hide():t.is(":first-child")?r.el.slideControls.previous.hide():(r.el.slideControls.next.show(),r.el.slideControls.previous.show()))}};d=e.extend(!0,{op:u},c,s),u.slideTemplatesPlaceholder&&0===e("#"+u.idSliceSlideTemplates).length?o():n()}}(jQuery);